(this.webpackJsonp=this.webpackJsonp||[]).push([[1347],{"E/jO":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return h}));n("Tznw"),n("IYH6"),n("6yen"),n("OeRx"),n("l/dT"),n("RqS2"),n("Zy7a"),n("cjZU"),n("OAhk"),n("X42P"),n("mHhP"),n("fn0I"),n("UB/6"),n("imhG"),n("kidC"),n("F/X0"),n("ZzK0"),n("z6RN"),n("BzOf"),n("B++/"),n("47t/");const a=function({nodeType:e}){return 3===e},i=function(e,t){const n=document.createElement("span");return n.innerText=e,n.classList=t||"",n},l=function(e,t,n){const l=i();return l.innerHTML=function(e){return e.replace(/ /g,i(" ").outerHTML).replace(/\t/g,i("\t").outerHTML)}(e),l.childNodes.forEach((function(l){return function(e,t,n,l){if(a(e)&&(r=e.textContent,s=t,(o=r)&&!/^\s*$/.test(o)&&r.trim()===s.trim())){const a=i(t.trim(),n);Object.assign(a.dataset,l),e.replaceWith(a)}var r,s,o}(l,e,t,n)})),l.childNodes},r=new Map,s=new WeakSet,o=function(){return r.get("current")},c=function(e){return r.set("current",e)},h=function({path:e,d:t,wrapTextNodes:n}){const i=t.start_line+1,r=document.querySelector(`[data-path="${e}"]`).querySelectorAll(`.blob-content #LC${i}, .line_content:not(.old) #LC${i}`);null!=r&&r.length&&r.forEach((function(e){if(void 0===t.end_line)!function({d:e,line:t,wrapTextNodes:n}){let i=0;n&&(t.childNodes.forEach((function(e){e.replaceWith(...l(e.textContent,e.classList,e.dataset))})),s.add(t));const r=[...t.childNodes].find((function({textContent:t}){return i===e.start_char||(i+=t.length,!1)}));r&&!a(r)&&(r.dataset.charIndex=e.start_char,r.dataset.lineIndex=e.start_line,r.classList.add("cursor-pointer","code-navigation","js-code-navigation"),r.closest(".line").classList.add("code-navigation-line"))}({d:t,line:e,wrapTextNodes:n});else{const n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT);let a=0,i=n.nextNode();for(;i&&!(t.start_char>=a&&t.end_char<=a+i.textContent.length);)a+=i.textContent.length,i=n.nextNode();if(i&&t.start_char!==t.end_char){const n=i.textContent,l=t.end_char-t.start_char,r=t.start_char-a,s=document.createElement("span");s.textContent=n.slice(r,r+l),s.dataset.charIndex=t.start_char,s.dataset.lineIndex=t.start_line,s.classList.add("gl-cursor-pointer","code-navigation","js-code-navigation"),i.replaceWith(n.slice(0,r),s,n.slice(r+l)),e.classList.add("code-navigation-line")}}}))}},klTQ:function(e,t,n){"use strict";n.r(t);var a=n("Tmea"),i=n.n(a),l=(n("RFHG"),n("z6RN"),n("xuo1"),n("v2fZ"),n("GuZl")),r=n("Mp8J"),s=n("ygVz");const o=[{selector:".file-line-blame",property:"blame"},{selector:".file-line-num",property:"link"}];var c=function(){const e=document.querySelector(".file-holder");if(!e)return;e.addEventListener("click",(function(e){o.forEach((function(t){e.target.matches(t.selector)&&s.b.event(void 0,"click_link",{label:"file_line_action",property:t.property})}))}))},h=n("0hIY"),d=n("TPPX"),u=(n("ZzK0"),n("BzOf"),n("yi8e")),g=n("ehHk"),p=n("C5t3"),b=n("E/jO"),f={components:{GlIntersectionObserver:g.a},directives:{SafeHtml:r.a},props:{isHighlighted:{type:Boolean,required:!0},chunkIndex:{type:Number,required:!1,default:0},rawContent:{type:String,required:!0},highlightedContent:{type:String,required:!0},totalLines:{type:Number,required:!1,default:0},startingFrom:{type:Number,required:!1,default:0},blamePath:{type:String,required:!0},blobPath:{type:String,required:!0}},data:()=>({number:void 0,hasAppeared:!1}),computed:{...Object(u.f)(["data","blobs"]),shouldHighlight(){return Boolean(this.highlightedContent)&&(this.hasAppeared||this.isHighlighted)},pageSearchString(){const e=Object(p.a)(this.number);return Object(p.b)(this.blamePath,e)},codeStyling(){var e;return{marginLeft:((null===(e=this.$refs.lineNumbers)||void 0===e?void 0:e.offsetWidth)||96)+"px"}}},watch:{shouldHighlight:{handler(e){var t,n=this;null!==(t=this.blobs)&&void 0!==t&&t.length&&e&&(this.data?this.addCodeNavigationClasses():this.codeNavigationDataWatcher=this.$watch("data",(function(){n.addCodeNavigationClasses(),n.codeNavigationDataWatcher()})))},immediate:!0}},methods:{handleChunkAppear(){this.hasAppeared=!0,this.$emit("appear")},calculateLineNumber(e){return this.startingFrom+e+1},async addCodeNavigationClasses(){var e=this;await this.$nextTick(),Object.keys(this.data[this.blobPath]).forEach((function(t){const n=Number(t.split(":")[0]);n>=e.startingFrom&&n<e.startingFrom+e.totalLines+1&&Object(b.a)({path:e.blobPath,d:e.data[e.blobPath][t]})}))}}},m=n("tBpV"),v=Object(m.a)(f,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"gl-flex"},[e.shouldHighlight?t("div",{staticClass:"gl-absolute gl-flex gl-flex-col"},e._l(e.totalLines,(function(n,a){return t("div",{key:a,staticClass:"diff-line-num line-links line-numbers gl-border-r gl-z-3 gl-flex !gl-p-0",attrs:{"data-testid":"line-numbers"}},[t("a",{staticClass:"file-line-blame gl-select-none !gl-shadow-none",attrs:{"data-event-tracking":"click_chunk_blame_on_blob_page",href:`${e.blamePath}${e.pageSearchString}#L${e.calculateLineNumber(a)}`}}),e._v(" "),t("a",{staticClass:"file-line-num gl-select-none !gl-shadow-none",attrs:{id:"L"+e.calculateLineNumber(a),href:"#L"+e.calculateLineNumber(a),"data-line-number":e.calculateLineNumber(a)}},[e._v("\n        "+e._s(e.calculateLineNumber(a))+"\n      ")])])})),0):t("div",{ref:"lineNumbers",staticClass:"line-numbers gl-mr-3 !gl-p-0 gl-text-transparent"}),e._v(" "),t("gl-intersection-observer",{staticClass:"gl-w-full",on:{appear:e.handleChunkAppear}},[t("pre",{staticClass:"code highlight gl-m-0 gl-w-full !gl-overflow-visible !gl-border-none !gl-p-0 gl-leading-0"},[e.shouldHighlight?t("code",{directives:[{name:"safe-html",rawName:"v-safe-html",value:e.highlightedContent,expression:"highlightedContent"}],style:e.codeStyling,attrs:{"data-testid":"content"}}):e._m(0)])])],1)}),[function(){return(0,this._self._c)("code",{staticClass:"line !gl-whitespace-pre-wrap gl-ml-1",attrs:{"data-testid":"content"},domProps:{textContent:this._s(this.rawContent)}})}],!1,null,null,null).exports,C=n("L9Ro"),w=n("bds0"),_=n("s6YX"),y=n.n(_),x={name:"SourceViewer",components:{Chunk:v,Blame:C.a,CodeownersValidation:function(){return n.e(1234).then(n.bind(null,"VXh7"))}},directives:{SafeHtml:r.a},mixins:[s.b.mixin()],props:{blob:{type:Object,required:!0},chunks:{type:Array,required:!1,default:function(){return[]}},showBlame:{type:Boolean,required:!1,default:!1},projectPath:{type:String,required:!0},currentRef:{type:String,required:!0}},data:()=>({lineHighlighter:new h.a,blameData:[],renderedChunks:[]}),computed:{blameInfo(){var e=this;return this.blameData.reduce((function(t,n,a){return Object(w.b)(e.blameData,a)&&t.push({...n,blameOffset:Object(w.a)(n.lineno,a)}),t}),[])},isCodeownersFile(){return this.blob.name===d.d}},watch:{showBlame:{handler(e){Object(w.c)(this.blameData,e),this.requestBlameInfo(this.renderedChunks[0])},immediate:!0},blameData:{handler(e){this.showBlame&&Object(w.c)(e,!0)},immediate:!0},chunks:{handler(){this.selectLine()}}},mounted(){this.selectLine()},created(){this.handleAppear=i()(this.handleChunkAppear,l.h),this.track(d.e,{label:d.g,property:this.blob.language}),c()},methods:{async handleChunkAppear(e,t=!0){this.renderedChunks.includes(e)||(this.renderedChunks.push(e),await this.requestBlameInfo(e),e>0&&t&&this.handleChunkAppear(e-1,!1))},async requestBlameInfo(e){var t,n;const a=this.chunks[e];if(!this.showBlame||!a)return;const{data:i}=await this.$apollo.query({query:y.a,variables:{ref:this.currentRef,fullPath:this.projectPath,filePath:this.blob.path,fromLine:a.startingFrom+1,toLine:a.startingFrom+a.totalLines}}),l=null==i||null===(t=i.project)||void 0===t||null===(t=t.repository)||void 0===t||null===(t=t.blobs)||void 0===t?void 0:t.nodes[0],r=null==l||null===(n=l.blame)||void 0===n?void 0:n.groups,s=this.blameData.includes(r[0]);r&&!s&&this.blameData.push(...r)},async selectLine(){await this.$nextTick(),this.lineHighlighter.highlightHash(this.$route.hash)}},userColorScheme:window.gon.user_color_scheme},k=Object(m.a)(x,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"gl-flex"},[e.showBlame&&e.blameInfo.length?t("blame",{attrs:{"blame-info":e.blameInfo}}):e._e(),e._v(" "),t("div",{staticClass:"file-content code js-syntax-highlight blob-content blob-viewer gl-flex gl-w-full gl-flex-col gl-overflow-auto",class:e.$options.userColorScheme,attrs:{"data-type":"simple","data-path":e.blob.path,"data-testid":"blob-viewer-file-content"}},[e.isCodeownersFile?t("codeowners-validation",{staticClass:"gl-text-default",attrs:{"current-ref":e.currentRef,"project-path":e.projectPath,"file-path":e.blob.path}}):e._e(),e._v(" "),e._l(e.chunks,(function(n,a){return t("chunk",{key:a,attrs:{"chunk-index":a,"is-highlighted":Boolean(n.isHighlighted),"raw-content":n.rawContent,"highlighted-content":n.highlightedContent,"total-lines":n.totalLines,"starting-from":n.startingFrom,"blame-path":e.blob.blamePath,"blob-path":e.blob.path},on:{appear:function(){return e.handleAppear(a)}}})}))],2)],1)}),[],!1,null,null,null);t.default=k.exports}}]);
//# sourceMappingURL=1347.5e62de4a.chunk.js.map